from django.db import models
import gspread
import random
from django.conf import settings
from django.db.models import Q
from enum import Enum
from telegram import *


class Questions(models.Model):
    questing_id = models.IntegerField('–ù–æ–º–µ—Ä –≤–æ–ø—Ä–æ—Å–∞')
    block_name = models.CharField('–ë–ª–æ–∫', max_length=100)
    questing_text = models.TextField('–í–æ–ø—Ä–æ—Å')
    answer_one_text = models.TextField('–û—Ç–≤–µ—Ç 1', null=True, blank=True)
    answer_one_balls = models.IntegerField('–ë–∞–ª–ª—ã –∑–∞ –æ—Ç–≤–µ—Ç 1', null=True, blank=True)

    answer_two_text = models.TextField('–û—Ç–≤–µ—Ç 2', null=True, blank=True)
    answer_two_balls = models.IntegerField('–ë–∞–ª–ª—ã –∑–∞ –æ—Ç–≤–µ—Ç 2', null=True, blank=True)

    answer_three_text = models.TextField('–û—Ç–≤–µ—Ç 3', null=True, blank=True)
    answer_three_balls = models.IntegerField('–ë–∞–ª–ª—ã –∑–∞ –æ—Ç–≤–µ—Ç 3', null=True, blank=True)

    answer_four_text = models.TextField('–û—Ç–≤–µ—Ç 4', null=True, blank=True)
    answer_four_balls = models.IntegerField('–ë–∞–ª–ª—ã –∑–∞ –æ—Ç–≤–µ—Ç 4', null=True, blank=True)

    answer_five_text = models.TextField('–û—Ç–≤–µ—Ç 5', null=True, blank=True)
    answer_five_balls = models.IntegerField('–ë–∞–ª–ª—ã –∑–∞ –æ—Ç–≤–µ—Ç 5', null=True, blank=True)

    answer_count = models.IntegerField('–ö–æ–ª-–≤–æ –æ—Ç–≤–µ—Ç–æ–≤')

    class Meta:
        verbose_name = '–í–æ–ø—Ä–æ—Å'
        verbose_name_plural = '–í–æ–ø—Ä–æ—Å—ã'
        ordering = ['-id']

    def __str__(self):
        return f'{self.block_name} #{self.questing_id}: {self.questing_text}'

    objects = models.QuerySet.as_manager()

    @classmethod
    def refresh(cls):
        gc = gspread.service_account(filename=settings.GOOGLE_CREDENTIALS_FILE_PATH)
        spreadsheet = gc.open_by_key(settings.ADVISORS_QUESTIONS_SPREADSHEET_ID)
        cls.objects.all().delete()
        worksheets = list(spreadsheet.worksheets())
        for worksheet in worksheets:
            values = list(worksheet.get_all_values())
            for row in values:
                if row[0] == '‚Ññ':
                    continue

                new_q = cls(
                    questing_id=row[0],
                    block_name=worksheet.title,
                    questing_text=row[2],
                    answer_one_text=row[3] if row[3] != '' else '',
                    answer_one_balls=row[4] if row[4] != '' else 0,
                    answer_two_text=row[5] if row[5] != '' else '',
                    answer_two_balls=row[6] if row[6] != '' else 0,
                    answer_three_text=row[7] if row[7] != '' else '',
                    answer_three_balls=row[8] if row[8] != '' else 0,
                    answer_four_text=row[9] if row[9] != '' else '',
                    answer_four_balls=row[10] if row[10] != '' else 0,
                    answer_five_text=row[11] if row[11] != '' else '',
                    answer_five_balls=row[12] if row[12] != '' else 0,
                    answer_count=row[13]
                )
                new_q.save()

    @classmethod
    def get_questions_list(cls) -> list:
        all_questions = cls.objects.all()

        list_ids = random.sample(range(1, len(all_questions.filter(block_name='–ü—Ä–∞–≤–æ–≤—ã–µ'))), 8)
        list_one = list(all_questions.filter(Q(block_name='–ü—Ä–∞–≤–æ–≤—ã–µ') & Q(questing_id__in=list_ids)))

        list_two_count = len(all_questions.filter(block_name='–ü—Å–∏—Ö–æ–ª–æ–≥–æ-–ø–µ–¥–∞–≥–æ–≥–∏—á–µ—Å–∫–∏–µ'))
        if list_two_count > 8:
            list_ids = random.sample(range(1, list_two_count), 8)
            list_two = list(
                all_questions.filter(Q(block_name='–ü—Å–∏—Ö–æ–ª–æ–≥–æ-–ø–µ–¥–∞–≥–æ–≥–∏—á–µ—Å–∫–∏–µ') & Q(questing_id__in=list_ids)))
        else:
            list_two = list(all_questions.filter(block_name='–ü—Å–∏—Ö–æ–ª–æ–≥–æ-–ø–µ–¥–∞–≥–æ–≥–∏—á–µ—Å–∫–∏–µ'))

        list_ids = random.sample(range(1, len(all_questions.filter(block_name='–£–ø—Ä–∞–≤–ª–µ–Ω—á–µ—Å–∫–∏–µ'))), 8)
        list_three = list(all_questions.filter(Q(block_name='–£–ø—Ä–∞–≤–ª–µ–Ω—á–µ—Å–∫–∏–µ') & Q(questing_id__in=list_ids)))

        list_ids = random.sample(range(1, len(all_questions.filter(block_name='–¶–µ–Ω–Ω–æ—Å—Ç–Ω–æ-—Å–æ–¥–µ—Ä–∂–∞—Ç–µ–ª—å–Ω—ã–µ'))), 8)
        list_four = list(all_questions.filter(Q(block_name='–¶–µ–Ω–Ω–æ—Å—Ç–Ω–æ-—Å–æ–¥–µ—Ä–∂–∞—Ç–µ–ª—å–Ω—ã–µ') & Q(questing_id__in=list_ids)))

        question_list = list_one + list_two + list_three + list_four
        random.shuffle(question_list)
        return question_list


class InterviewStep(Enum):
    start = 'start'  # /start
    start_1 = 'start_1'  # –° –ø–æ–ª–æ–∂–µ–Ω–∏–µ–º –æ–∑–Ω–∞–∫–æ–º–ª–µ–Ω
    start_2 = 'start_2'  # –î–∞—é —Å–æ–≥–ª–∞—Å–∏–µ –Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫—É –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
    start_3 = 'start_3'  # –ü—Ä–∞–≤–∏–ª–∞ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è
    start_4 = 'start_4'  # –í—Å–µ –ø–æ–Ω—è—Ç–Ω–æ
    start_end = 'start_end'  # –°–¢–ê–†–¢

    surname = 'surname'
    name = 'firstname'
    patronymic = 'patronymic'
    date_of_birth = 'date_of_birth'
    gender = 'gender'
    photo = 'photo'
    phone_number = 'phone_number'
    email = 'email'
    social_networks = 'social_networks'
    education = 'education'
    place_education = 'place_education'
    place_education_2 = 'place_education_2'
    napr_education = 'napr_education'
    place_education_stop = 'place_education_stop'
    doc_education = 'doc_education'
    add_education = 'add_education'
    work_experience = 'work_experience'
    job_title = 'job_title'
    add_work = 'add_work'
    prof_skills = 'prof_skills'
    pers_qualities = 'pers_qualities'
    achievements = 'achievements'
    exp_children = 'exp_children'
    ed_oo_work = 'ed_oo_work'
    adm_okr = 'adm_okr'
    add_adm_okr = 'add_adm_okr'

    start_test = 'start_test'
    test = 'test'
    finish = 'finish'
    finish_end = 'finish_end'
    end = 'end'


class Interview(models.Model):
    chat_id = models.CharField('Chat id', max_length=100)
    step = models.CharField('–≠—Ç–∞–ø –æ–ø—Ä–æ—Å–∞', max_length=100, default=InterviewStep.start.value)
    interview_answers = models.JSONField('–û—Ç–≤–µ—Ç—ã –æ–ø—Ä–æ—Å–∞', default=dict)
    google_table_row = models.IntegerField('–°—Ç—Ä–æ–∫–∞ –≤ –≥—É–≥–ª —Ç–∞–±–ª–∏—Ü–µ', null=True, blank=True, default=None)
    test_finish_time = models.DateTimeField('–í—Ä–µ–º—è –æ–∫–æ–Ω—á–∞–Ω–∏—è —Ç–µ—Å—Ç–∞', null=True, blank=True, default=None)
    questing_text = models.JSONField('–í–æ–ø—Ä–æ—Å—ã', null=True)
    questing_step = models.IntegerField('–ê–∫—Ç—É–∞–ª—å–Ω—ã–π –≤–æ–ø—Ä–æ—Å', default=-1)
    questing_balls = models.IntegerField('–ö–æ–ª-–≤–æ –±–∞–ª–æ–≤', default=0)
    is_need_send = models.BooleanField('–ù—É–∂–Ω–æ –ª–∏ –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ', default=0)
    is_send_final_message = models.BooleanField('–û—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ –ø–æ—Å–ª–µ–¥–Ω–µ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ', default=0)
    video_url = models.CharField('–°—Å—ã–ª–∫–∞ –Ω–∞ –≤–∏–¥–µ–æ', max_length=2000, default=None, null=True)

    objects = models.QuerySet.as_manager()

    class Meta:
        verbose_name = '–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è'
        verbose_name_plural = '–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è'
        ordering = ['-id']

    def __str__(self):
        return f'#{self.chat_id}; step - {self.step}'

    def update_step(self, step: InterviewStep):
        self.step = step.value
        self.save()

    def save_interview_answers_to_table(self):
        def next_available_row(worksheet):
            str_list = list(filter(None, worksheet.get_all_values()))
            return str(len(str_list) + 1)

        gc = gspread.service_account(filename=settings.GOOGLE_CREDENTIALS_FILE_PATH)
        spreadsheet = gc.open_by_key(settings.ADVISORS_RESULT_SPREADSHEET_ID)
        sheet = spreadsheet.worksheet('–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –æ–ø—Ä–æ—Å–∞')
        next_row = next_available_row(sheet)
        interview_answers = dict(self.interview_answers)

        education_list = []
        for value in dict(interview_answers['education_list']).values():
            education_list.append(f'{value["place_education"]}, {value["napr_education"]}, '
                                  f'{value["place_education_stop"]}, '
                                  f'https://manager.cpvs.moscow/{value["doc_education"]};')

        work_list = []
        for value in dict(interview_answers['work_list']).values():
            work_list.append(f'{value["work_experience"]}, {value["job_title"]};')

        sheet.update(f'A{next_row}', [
            [
                interview_answers['surname'],
                interview_answers['name'],
                interview_answers['patronymic'],
                interview_answers['date_of_birth'],
                interview_answers['gender'],
                'https://manager.cpvs.moscow/' + interview_answers['photo'],
                interview_answers['phone_number'],
                interview_answers['email'],
                interview_answers['social_networks'],
                interview_answers['education_level'],
                interview_answers['place_education'],
                '\n'.join(education_list),
                '\n'.join(work_list),
                interview_answers['prof_skills'],
                interview_answers['pers_qualities'],
                interview_answers['achievements'],
                interview_answers['exp_children'],
                interview_answers['ed_oo_work'],
                ', '.join(list(interview_answers['adm_okr_list'])),
            ]
        ])
        self.google_table_row = next_row

    def save_test_result_to_table(self):
        gc = gspread.service_account(filename=settings.GOOGLE_CREDENTIALS_FILE_PATH)
        spreadsheet = gc.open_by_key(settings.ADVISORS_RESULT_SPREADSHEET_ID)
        sheet = spreadsheet.worksheet('–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –æ–ø—Ä–æ—Å–∞')
        values = sheet.col_values(8)
        interview_answers = dict(self.interview_answers)
        for idx, row in enumerate(values):
            lineIndex = idx + 1
            if not interview_answers.get('email'):
                continue
            if row == interview_answers['email']:
                sheet.update(f'T{lineIndex}', str(self.questing_balls))
                return

    def save_video_url_to_table(self):
        gc = gspread.service_account(filename=settings.GOOGLE_CREDENTIALS_FILE_PATH)
        spreadsheet = gc.open_by_key(settings.ADVISORS_RESULT_SPREADSHEET_ID)
        sheet = spreadsheet.worksheet('–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –æ–ø—Ä–æ—Å–∞')
        values = sheet.col_values(8)
        interview_answers = dict(self.interview_answers)
        for idx, row in enumerate(values):
            lineIndex = idx + 1
            if not interview_answers.get('email'):
                continue
            if row == interview_answers['email']:
                sheet.update(f'U{lineIndex}', str(self.video_url))
                return

    @classmethod
    def send_finish_message(cls):
        gc = gspread.service_account(filename=settings.GOOGLE_CREDENTIALS_FILE_PATH)
        spreadsheet = gc.open_by_key(settings.ADVISORS_RESULT_SPREADSHEET_ID)
        sheet = spreadsheet.worksheet('–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –æ–ø—Ä–æ—Å–∞')
        values = sheet.get_all_values()
        rows = {}
        for idx, row in enumerate(values):
            if row[22] == '':
                continue
            if row[22] == '0' or row[22] == '6' or row[22] == '7':
                rows.setdefault(row[7], {
                    'line': idx + 1,
                    'isNeedSend': row[22]
                })
        message0 = '''
        –ó–¥—Ä–∞–≤—Å—Ç–≤—É–π—Ç–µ, —É–≤–∞–∂–∞–µ–º—ã–π —É—á–∞—Å—Ç–Ω–∏–∫ –∫–æ–Ω–∫—É—Ä—Å–∞ ¬´–ù–∞–≤–∏–≥–∞—Ç–æ—Ä—ã –î–µ—Ç—Å—Ç–≤–∞¬ª!

–ö —Å–æ–∂–∞–ª–µ–Ω–∏—é, –í—ã –Ω–µ –Ω–∞–±—Ä–∞–ª–∏ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –±–∞–ª–ª–æ–≤ –ø–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º –ø–µ—Ä–≤–æ–≥–æ –∏ –≤—Ç–æ—Ä–æ–≥–æ —ç—Ç–∞–ø–æ–≤ –¥–ª—è –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏—è –≤ —Å–ª–µ–¥—É—é—â–∏–π —ç—Ç–∞–ø. 

–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –í—ã —Å–º–æ–∂–µ—Ç–µ –ø–æ–ª—É—á–∏—Ç—å –ø–æ—Å–ª–µ –ø—Ä–æ–≤–µ–¥–µ–Ω–∏—è –≤—Å–µ—Ö —ç—Ç–∞–ø–æ–≤ –∫–æ–Ω–∫—É—Ä—Å–∞. 

–ë–ª–∞–≥–æ–¥–∞—Ä–∏–º –í–∞—Å –∑–∞ —É—á–∞—Å—Ç–∏–µ –≤ –∫–æ–Ω–∫—É—Ä—Å–µ!üëç
        '''
        message6 = '''
–£–≤–∞–∂–∞–µ–º—ã–π –∫–∞–Ω–¥–∏–¥–∞—Ç!

–ü—Ä–∏–≥–ª–∞—à–∞–µ–º –í–∞—Å –ø—Ä–∏–Ω—è—Ç—å —É—á–∞—Å—Ç–∏–µ –≤ 3 —ç—Ç–∞–ø–µ –º–æ—Å–∫–æ–≤—Å–∫–æ–≥–æ –≥–æ—Ä–æ–¥—Å–∫–æ–≥–æ –∫–æ–Ω–∫—É—Ä—Å–∞ ¬´–ù–∞–≤–∏–≥–∞—Ç–æ—Ä—ã –¥–µ—Ç—Å—Ç–≤–∞¬ª, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–æ–π–¥–µ—Ç –≤ —Ñ–æ—Ä–º–∞—Ç–µ –≥—Ä—É–ø–ø–æ–≤–æ–≥–æ –∏ –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω–æ–≥–æ —Å–æ–±–µ—Å–µ–¥–æ–≤–∞–Ω–∏—è.

–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ—Å—å –ø–æ —Å—Å—ã–ª–∫–µ:

https://clubovp-mcps.timepad.ru/event/2357146/

–ü–µ—Ä–µ–π–¥—è –ø–æ —Å—Å—ã–ª–∫–µ, –≤—ã–±–µ—Ä–∏—Ç–µ –¥–∞—Ç—É –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Å–æ–≥–ª–∞—Å–Ω–æ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω–æ–º—É –æ–∫—Ä—É–≥—É, –≤ –∫–æ—Ç–æ—Ä–æ–º –í—ã —Ä–∞–±–æ—Ç–∞–µ—Ç–µ: 

27 –º–∞—Ä—Ç–∞ - –Æ–í–ê–û, –°–ó–ê–û
28 –º–∞—Ä—Ç–∞ - –Æ–ê–û, –¶–ê–û
29 –º–∞—Ä—Ç–∞ - –°–í–ê–û, –°–ê–û
30 –º–∞—Ä—Ç–∞ - –Æ–ó–ê–û, –ó–ê–û
31 –º–∞—Ä—Ç–∞ - –í–ê–û, –¢–∏–ù–ê–û, –ó–µ–ª–ê–û


üè´–ú–µ—Å—Ç–æ –ø—Ä–æ–≤–µ–¥–µ–Ω–∏—è: –ö–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω—ã–π —É–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç
üìç–ê–¥—Ä–µ—Å: –≥. –ú–æ—Å–∫–≤–∞, –ü—Ä–µ—á–∏—Å—Ç–µ–Ω—Å–∫–∏–π –ø–µ—Ä–µ—É–ª–æ–∫, –¥. 7–ê

‚è≥–ü—Ä–æ–¥–æ–ª–∂–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å: 1 —á–∞—Å

–ü—Ä–æ—Å–∏–º –í–∞—Å –ø—Ä–æ–π—Ç–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—é –¥–æ 22 –º–∞—Ä—Ç–∞ –≤–∫–ª—é—á–∏—Ç–µ–ª—å–Ω–æ.

–û–±—Ä–∞—â–∞–µ–º –≤–Ω–∏–º–∞–Ω–∏–µ, —á—Ç–æ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–º —É—Å–ª–æ–≤–∏–µ–º –¥–ª—è —É—á–∞—Å—Ç–∏—è –≤ –∏—Ç–æ–≥–æ–≤–æ–º —Å–æ–±–µ—Å–µ–¥–æ–≤–∞–Ω–∏–∏ —è–≤–ª—è–µ—Ç—Å—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏, –∫–æ—Ç–æ—Ä–æ–µ –ø—Ä–∏–¥–µ—Ç –í–∞–º –Ω–∞ –ø–æ—á—Ç—É, —É–∫–∞–∑–∞–Ω–Ω—É—é –ø—Ä–∏ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏–∏ —Ñ–æ—Ä–º—ã —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏.

–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –º–µ—Å—Ç –Ω–∞ –∏—Ç–æ–≥–æ–≤–æ–µ —Å–æ–±–µ—Å–µ–¥–æ–≤–∞–Ω–∏–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–æ. –ï—Å–ª–∏ –≤—ã –Ω–µ —É—Å–ø–µ–ª–∏ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è - –Ω–µ –ø–µ—Ä–µ–∂–∏–≤–∞–π—Ç–µ. 
–ü–æ–∑–∂–µ –ø–æ—è–≤—è—Ç—Å—è –Ω–æ–≤—ã–µ –¥–∞—Ç—ã –∏ –≤—Ä–µ–º—è –¥–ª—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –ø–æ —Ç–æ–π –∂–µ —Å—Å—ã–ª–∫–µ. –°–ª–µ–¥–∏—Ç–µ –∑–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è–º–∏. 

–°–ø–∞—Å–∏–±–æ!
–î–æ –≤—Å—Ç—Ä–µ—á–∏üëç
        '''
        message7 = '''
–£–≤–∞–∂–∞–µ–º—ã–π –∫–∞–Ω–¥–∏–¥–∞—Ç!

–ü—Ä–∏–≥–ª–∞—à–∞–µ–º –í–∞—Å –ø—Ä–∏–Ω—è—Ç—å —É—á–∞—Å—Ç–∏–µ –≤ 3 —ç—Ç–∞–ø–µ –º–æ—Å–∫–æ–≤—Å–∫–æ–≥–æ –≥–æ—Ä–æ–¥—Å–∫–æ–≥–æ –∫–æ–Ω–∫—É—Ä—Å–∞ ¬´–ù–∞–≤–∏–≥–∞—Ç–æ—Ä—ã –¥–µ—Ç—Å—Ç–≤–∞¬ª, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–æ–π–¥–µ—Ç –≤ —Ñ–æ—Ä–º–∞—Ç–µ –≥—Ä—É–ø–ø–æ–≤–æ–≥–æ –∏ –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω–æ–≥–æ —Å–æ–±–µ—Å–µ–¥–æ–≤–∞–Ω–∏—è.

–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ—Å—å –ø–æ —Å—Å—ã–ª–∫–µ:

https://clubovp-mcps.timepad.ru/event/2357146/

–ü–µ—Ä–µ–π–¥—è –ø–æ —Å—Å—ã–ª–∫–µ, –≤—ã–±–µ—Ä–∏—Ç–µ –¥–∞—Ç—É –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Å–æ–≥–ª–∞—Å–Ω–æ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω–æ–º—É –æ–∫—Ä—É–≥—É, –≤ –∫–æ—Ç–æ—Ä–æ–º –í—ã —Ä–∞–±–æ—Ç–∞–µ—Ç–µ: 

3 –∞–ø—Ä–µ–ª—è - –Æ–í–ê–û, –°–ó–ê–û
4 –∞–ø—Ä–µ–ª—è - –Æ–ê–û, –¶–ê–û
5 –∞–ø—Ä–µ–ª—è - –°–í–ê–û, –°–ê–û
6 –∞–ø—Ä–µ–ª—è - –Æ–ó–ê–û, –ó–ê–û
7 –∞–ø—Ä–µ–ª—è - –í–ê–û, –¢–∏–ù–ê–û, –ó–µ–ª–ê–û


üè´–ú–µ—Å—Ç–æ –ø—Ä–æ–≤–µ–¥–µ–Ω–∏—è: –ö–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω—ã–π —É–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç
üìç–ê–¥—Ä–µ—Å: –≥. –ú–æ—Å–∫–≤–∞, –ü—Ä–µ—á–∏—Å—Ç–µ–Ω—Å–∫–∏–π –ø–µ—Ä–µ—É–ª–æ–∫, –¥. 7–ê

‚è≥–ü—Ä–æ–¥–æ–ª–∂–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å: 1 —á–∞—Å

–ü—Ä–æ—Å–∏–º –í–∞—Å –ø—Ä–æ–π—Ç–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—é –¥–æ 29 –º–∞—Ä—Ç–∞ –≤–∫–ª—é—á–∏—Ç–µ–ª—å–Ω–æ.

–û–±—Ä–∞—â–∞–µ–º –≤–Ω–∏–º–∞–Ω–∏–µ, —á—Ç–æ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–º —É—Å–ª–æ–≤–∏–µ–º –¥–ª—è —É—á–∞—Å—Ç–∏—è –≤ –∏—Ç–æ–≥–æ–≤–æ–º —Å–æ–±–µ—Å–µ–¥–æ–≤–∞–Ω–∏–∏ —è–≤–ª—è–µ—Ç—Å—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏, –∫–æ—Ç–æ—Ä–æ–µ –ø—Ä–∏–¥–µ—Ç –í–∞–º –Ω–∞ –ø–æ—á—Ç—É, —É–∫–∞–∑–∞–Ω–Ω—É—é –ø—Ä–∏ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏–∏ —Ñ–æ—Ä–º—ã —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏.

–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –º–µ—Å—Ç –Ω–∞ –∏—Ç–æ–≥–æ–≤–æ–µ —Å–æ–±–µ—Å–µ–¥–æ–≤–∞–Ω–∏–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–æ. –ï—Å–ª–∏ –≤—ã –Ω–µ —É—Å–ø–µ–ª–∏ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è - –Ω–µ –ø–µ—Ä–µ–∂–∏–≤–∞–π—Ç–µ. 
–ü–æ–∑–∂–µ –ø–æ—è–≤—è—Ç—Å—è –Ω–æ–≤—ã–µ –¥–∞—Ç—ã –∏ –≤—Ä–µ–º—è –¥–ª—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –ø–æ —Ç–æ–π –∂–µ —Å—Å—ã–ª–∫–µ. –°–ª–µ–¥–∏—Ç–µ –∑–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è–º–∏. 

–°–ø–∞—Å–∏–±–æ!
–î–æ –≤—Å—Ç—Ä–µ—á–∏üëç
        '''

        bot = Bot(token=settings.ADVISORS_BOT_TOKE)
        interviews = Interview.objects.filter(is_send_final_message=0)
        for interview in interviews:
            interview_answers = dict(interview.interview_answers)
            if not interview_answers.get('email'):
                continue
            rowItem = rows.get(interview_answers['email'])
            if not rowItem:
                continue
            try:
                # if rowItem['isNeedSend'] == '0':
                #     bot.send_message(
                #         chat_id=interview.chat_id,
                #         text=message0,
                #         parse_mode=ParseMode.HTML,
                #         reply_markup=ReplyKeyboardRemove()
                #     )
                #     interview.is_send_final_message = 1
                #     interview.save()
                # if rowItem['isNeedSend'] == '6':
                #     bot.send_message(
                #         chat_id=interview.chat_id,
                #         text=message6,
                #         parse_mode=ParseMode.HTML,
                #         reply_markup=ReplyKeyboardRemove()
                #     )
                #     interview.is_send_final_message = 1
                #     interview.save()
                if rowItem['isNeedSend'] == '7':
                    bot.send_message(
                        chat_id=interview.chat_id,
                        text=message7,
                        parse_mode=ParseMode.HTML,
                        reply_markup=ReplyKeyboardRemove()
                    )
                    interview.is_send_final_message = 1
                    interview.save()
            except Exception as error:
                bot.send_message(text=f'–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–ª–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –ø–æ—Å–ª–µ–¥–Ω–µ–º —ç—Ç–∞–ø–µ ‚Ññ {str(interview.chat_id)} ({str(interview_answers["email"])}) {str(error)}', chat_id=453548866)

        return rows

    @classmethod
    def send_result_message(cls):
        gc = gspread.service_account(filename=settings.GOOGLE_CREDENTIALS_FILE_PATH)
        spreadsheet = gc.open_by_key(settings.ADVISORS_RESULT_SPREADSHEET_ID)
        sheet = spreadsheet.worksheet('–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –æ–ø—Ä–æ—Å–∞')
        values = sheet.get_all_values()
        rows = {}
        for idx, row in enumerate(values):
            if row[21] == '':
                continue
            rows.setdefault(row[7], {
                'line': idx + 1,
                'isNeedSend': row[21]
            })
        bot = Bot(token=settings.ADVISORS_BOT_TOKE)
        interviews = Interview.objects.filter(is_send_final_message=0)
        message11 = '''
–ó–¥—Ä–∞–≤—Å—Ç–≤—É–π—Ç–µ, —É–≤–∞–∂–∞–µ–º—ã–π —É—á–∞—Å—Ç–Ω–∏–∫ –∫–æ–Ω–∫—É—Ä—Å–∞ ¬´–ù–∞–≤–∏–≥–∞—Ç–æ—Ä—ã –î–µ—Ç—Å—Ç–≤–∞¬ª!
üéâ–ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º, –í—ã —É—Å–ø–µ—à–Ω–æ –ø—Ä–æ—à–ª–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—é –∏ –ø—Ä–æ—Ü–µ–¥—É—Ä—É —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è.

–ú—ã —Ä–∞–¥—ã —Å–æ–æ–±—â–∏—Ç—å, —á—Ç–æ –í—ã –ø—Ä–æ—Ö–æ–¥–∏—Ç–µ –≤ —Å–ª–µ–¥—É—é—â–∏–π —ç—Ç–∞–ø –∫–æ–Ω–∫—É—Ä—Å–∞.
–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –≤—Ç–æ—Ä–æ–º —ç—Ç–∞–ø–µ –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–∞ –≤ –±–ª–∏–∂–∞–π—à–µ–µ –≤—Ä–µ–º—è.
'''
        message12 = '''
        –£–≤–∞–∂–∞–µ–º—ã–π —É—á–∞—Å—Ç–Ω–∏–∫ –∫–æ–Ω–∫—É—Ä—Å–∞, –≤—ã —É—Å–ø–µ—à–Ω–æ —Å–ø—Ä–∞–≤–∏–ª–∏—Å—å —Å –ø–µ—Ä–≤—ã–º —ç—Ç–∞–ø–æ–º –∏ —Ç–µ–ø–µ—Ä—å –º–æ–∂–µ—Ç–µ –ø—Ä–∏—Å—Ç—É–ø–∏—Ç—å –∫ —Ç–≤–æ—Ä—á–µ—Å–∫–æ–º—É –∑–∞–¥–∞–Ω–∏—é.

–î–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–¥–∞–Ω–∏—è –≤–∞–º –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –ø–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å –≤–∏–¥–µ–æ—Ä–æ–ª–∏–∫, –≤ –∫–æ—Ç–æ—Ä–æ–º –Ω—É–∂–Ω–æ —Ä–∞—Å–∫—Ä—ã—Ç—å —Å–≤–æ—é —ç–∫—Å–ø–µ—Ä—Ç–Ω—É—é –ø–æ–∑–∏—Ü–∏—é –≤ –æ–¥–Ω–æ–π –∏–∑ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–Ω—ã—Ö —Ç–µ–º–∞—Ç–∏–∫:

‚ñ´Ô∏è–ú–æ—Ç–∏–≤–∞—Ü–∏—è –¥–µ—Ç–µ–π –∫ —É—á–∞—Å—Ç–∏—é –≤ —à–∫–æ–ª—å–Ω—ã—Ö —Å–æ–±—ã—Ç–∏—è—Ö –∏ –ø—Ä–æ–µ–∫—Ç–∞—Ö
‚ñ´Ô∏è–ù–∞—Ä—É—à–µ–Ω–∏–µ –ø—Ä–∞–≤–∏–ª –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–≥–æ —Ä–∞—Å–ø–æ—Ä—è–¥–∫–∞ —à–∫–æ–ª—ã
‚ñ´Ô∏è–†–æ–¥–∏—Ç–µ–ª—å—Å–∫–æ–µ –º–Ω–µ–Ω–∏–µ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è –¥–µ—Ç–µ–π –∏–ª–∏ –¥–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω–æ–π –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏
‚ñ´Ô∏è–ö—É–ª—å—Ç—É—Ä–∞ —á—Ç–µ–Ω–∏—è
‚ñ´Ô∏è–ú–æ—Ç–∏–≤–∞—Ü–∏—è –∫–ª–∞—Å—Å–Ω—ã—Ö —Ä—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª–µ–π (–ø–µ–¥–∞–≥–æ–≥–æ–≤)
‚ñ´Ô∏è–ß–µ–º—É —É—á–∏—Ç —à–∫–æ–ª–∞

–û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ –Ω–∞ –æ—Å–Ω–æ–≤–Ω—ã–µ —Å–æ—Å—Ç–∞–≤–ª—è—é—â–∏–µ –∏ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ –≤–∏–¥–µ–æ—Ä–∞–±–æ—Ç–µ:
‚Äì –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ –∏ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ —É—á–∞—Å—Ç–Ω–∏–∫–∞ (–Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —á–µ—Ç–∫–æ –ø—Ä–æ–∏–∑–Ω–µ—Å—Ç–∏ —Å–≤–æ—ë –§–ò–û);
‚Äì –≤—ã–±—Ä–∞–Ω–Ω–∞—è —Ç–µ–º–∞—Ç–∏–∫–∞ (–Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –æ–∑–≤—É—á–∏—Ç—å —Ç–µ–º–∞—Ç–∏–∫—É –≤–æ–ø—Ä–æ—Å–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é);
‚Äì –ø–æ—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø—Ä–æ–±–ª–µ–º—ã –≤ —Ä–∞–º–∫–∞—Ö –≤—ã–±—Ä–∞–Ω–Ω–æ–π —Ç–µ–º–∞—Ç–∏–∫–∏ (—á—Ç–æ –∏–º–µ–Ω–Ω–æ –∏ –¥–ª—è –∫–∞–∫–∏—Ö —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ –æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω—ã—Ö –æ—Ç–Ω–æ—à–µ–Ω–∏–π —è–≤–ª—è–µ—Ç—Å—è –ø—Ä–æ–±–ª–µ–º–æ–π);
‚Äì –ø—Ä–∏–º–µ—Ä—ã –∏–∑ –ª–∏—Ç–µ—Ä–∞—Ç—É—Ä–Ω—ã—Ö –∏–ª–∏ –¥—Ä—É–≥–∏—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤, –∏–ª–ª—é—Å—Ç—Ä–∏—Ä—É—é—â–∏–µ –¥–∞–Ω–Ω—É—é –ø—Ä–æ–±–ª–µ–º—É;
‚Äì –≤–∞—Ä–∏–∞–Ω—Ç—ã —Ä–µ—à–µ–Ω–∏—è –¥–∞–Ω–Ω–æ–π –ø—Ä–æ–±–ª–µ–º—ã (–ø—Ä–µ–¥–ª–∞–≥–∞–µ–º—ã–µ —Å–æ–±—ã—Ç–∏—è –∏–ª–∏ –¥–µ–π—Å—Ç–≤–∏—è –≤ –≤–æ—Å–ø–∏—Ç–∞—Ç–µ–ª—å–Ω–æ–π —Ä–∞–±–æ—Ç–µ, –∫–æ—Ç–æ—Ä—ã–µ –¥–æ–ª–∂–Ω—ã –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–æ –ø–æ–≤–ª–∏—è—Ç—å –Ω–∞ —Ä–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã);
‚Äì –≤–æ–∑–º–æ–∂–Ω—ã–µ —Å–ø–æ—Å–æ–±—ã –∏ –∫—Ä–∏—Ç–µ—Ä–∏–∏ –æ—Ü–µ–Ω–∫–∏ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –ø—Ä–µ–¥–ª–∞–≥–∞–µ–º–æ–≥–æ —Ä–µ—à–µ–Ω–∏—è;
‚Äì —É–∫–∞–∑–∞–Ω–∏–µ –ø—Ä–æ–≥–Ω–æ–∑–∏—Ä—É–µ–º—ã—Ö –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤;
‚Äì –æ—Ü–µ–Ω–∫–∞ –≤–æ–∑–º–æ–∂–Ω—ã—Ö –Ω–µ–≥–∞—Ç–∏–≤–Ω—ã—Ö –ø–æ—Å–ª–µ–¥—Å—Ç–≤–∏–π –ø—Ä–µ–¥–ª–∞–≥–∞–µ–º–æ–≥–æ —Ä–µ—à–µ–Ω–∏—è;
 ‚Äì –ø—Ä–∏–º–µ—Ä –∏–∑ –ª–∏—á–Ω–æ–≥–æ –∏–ª–∏ –æ–±—â–µ—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –æ–ø—ã—Ç–∞, –∏–ª–ª—é—Å—Ç—Ä–∏—Ä—É—é—â–∏–π —Ä–µ—à–µ–Ω–∏–µ —É–∫–∞–∑–∞–Ω–Ω–æ–π –∏–ª–∏ –∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ–π –ø—Ä–æ–±–ª–µ–º—ã;

–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –∫ –≤–∏–¥–µ–æ—Ä–æ–ª–∏–∫—É:
‚Ä¢–ø—Ä–æ–¥–æ–ª–∂–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –≤–∏–¥–µ–æ –Ω–µ –±–æ–ª–µ–µ 5 –º–∏–Ω—É—Ç
‚Ä¢—Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏: —Å—ä–µ–º–∫–∞ –æ–¥–Ω–∏–º –∫–∞–¥—Ä–æ–º, —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ–º–æ–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ –∏ —Ä–∞–∑–º–µ—Ä –≤–∏–¥–µ–æ –Ω–µ –º–µ–Ω–µ–µ 1280—Ö720 (720—Ä)
‚Ä¢—Ñ–æ—Ä–º–∞—Ç: mp4
‚Ä¢—Ä–∞–±–æ—Ç–∞ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –ø–æ–ª–Ω–æ—Å—Ç—å—é
–≤—ã–ø–æ–ª–Ω–µ–Ω–∞ —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ, –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —É–∂–µ –∏–º–µ—é—â–µ–≥–æ—Å—è –º–∞—Ç–µ—Ä–∏–∞–ª–∞ –≤ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–µ –∑–∞–ø—Ä–µ—â–µ–Ω–æ
‚Ä¢–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –ª–∏—á–Ω–æ–µ –ø—Ä–∏—Å—É—Ç—Å—Ç–≤–∏–µ —É—á–∞—Å—Ç–Ω–∏–∫–∞ –≤ –∫–∞–¥—Ä–µ
‚Ä¢ —Ä–µ—á—å —É—á–∞—Å—Ç–Ω–∏–∫–∞ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –≤–Ω—è—Ç–Ω–æ–π –∏ —Ä–∞–∑–±–æ—Ä—á–∏–≤–æ–π
‚Ä¢ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å —á–µ—Ç–∫–∏–º
‚Ä¢ –Ω–µ –¥–æ–ø—É—Å–∫–∞–µ—Ç—Å—è –Ω–∞–ª–∏—á–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ —Ä–µ–∫–ª–∞–º–Ω–æ–≥–æ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∞, –∞ —Ç–∞–∫–∂–µ –ª—é–±—ã—Ö —Ñ–æ—Ä–º –ø–æ–ª–∏—Ç–∏—á–µ—Å–∫–æ–π, —Ä–µ–ª–∏–≥–∏–æ–∑–Ω–æ–π –∏–ª–∏ –∏–Ω–æ–π –∏–¥–µ–æ–ª–æ–≥–∏—á–µ—Å–∫–æ–π –ø—Ä–æ–ø–∞–≥–∞–Ω–¥—ã, –æ—Å–∫–æ—Ä–±–ª–µ–Ω–∏—è —á—É–≤—Å—Ç–≤ –∏ –¥–æ—Å—Ç–æ–∏–Ω—Å—Ç–≤ –¥—Ä—É–≥–∏—Ö –ª—é–¥–µ–π, –Ω–µ–Ω–æ—Ä–º–∞—Ç–∏–≤–Ω–æ–π –ª–µ–∫—Å–∏–∫–∏

–° –∫—Ä–∏—Ç–µ—Ä–∏—è–º–∏ –æ—Ü–µ–Ω–∏–≤–∞–Ω–∏—è —Ç–≤–æ—Ä—á–µ—Å–∫–æ–π —Ä–∞–±–æ—Ç—ã –≤—ã –º–æ–∂–µ—Ç–µ –æ–∑–Ω–∞–∫–æ–º–∏—Ç—å—Å—è –≤ –ø–æ–ª–æ–∂–µ–Ω–∏–∏: https://patriotsport.moscow/wp-content/uploads/2023/02/polozhenie_o_konkurse_navigatory_detstva_08_02_23.pdf

–ì–æ—Ç–æ–≤—ã–π –≤–∏–¥–µ–æ—Ä–æ–ª–∏–∫ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –∑–∞–≥—Ä—É–∑–∏—Ç—å –≤ –æ–±–ª–∞—á–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ (—è–Ω–¥–µ–∫—Å.–¥–∏—Å–∫, OneDrive, –æ–±–ª–∞–∫–æ Mail.ru) –∏ –ø—Ä–∏—Å–ª–∞—Ç—å —Å—Å—ã–ª–∫—É –Ω–∞ —Ñ–∞–π–ª –≤ —ç—Ç–æ—Ç —á–∞—Ç, –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –æ—Ç–∫—Ä—ã—Ç—å –¥–æ—Å—Ç—É–ø –¥–ª—è —Å–∫–∞—á–∏–≤–∞–Ω–∏—è –∏ –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ —Ñ–∞–π–ª–∞.  –ù–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∑–∞–¥–∞–Ω–∏—è –æ—Ç–≤–æ–¥–∏—Ç—Å—è 10 –¥–Ω–µ–π —Å –º–æ–º–µ–Ω—Ç–∞ –ø—Ä–∏—Ö–æ–¥–∞ –¥–∞–Ω–Ω–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è.

–î–ª—è –æ–ø–µ—Ä–∞—Ç–∏–≤–Ω–æ–≥–æ –ø–µ—Ä–µ—Ö–æ–¥–∞ –∫ —Å–ª–µ–¥—É—é—â–µ–º—É —ç—Ç–∞–ø—É –∫–æ–Ω–∫—É—Ä—Å–∞ (–∏—Ç–æ–≥–æ–≤–æ–µ —Å–æ–±–µ—Å–µ–¥–æ–≤–∞–Ω–∏–µ) –ø—Ä–æ—Å–∏–º –Ω–∞–ø—Ä–∞–≤–∏—Ç—å —Å—Å—ã–ª–∫—É –Ω–∞ –≤–∏–¥–µ–æ—Ä–æ–ª–∏–∫ –¥–æ 12 –º–∞—Ä—Ç–∞ 2023 –≥–æ–¥–∞.

–û–±—Ä–∞—â–∞–µ–º –≤–Ω–∏–º–∞–Ω–∏–µ, —á—Ç–æ –æ—Ç–≤–µ—Ç–Ω—ã–º —Å–æ–æ–±—â–µ–Ω–∏–µ–º –∑–¥–µ—Å—å –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –ø—Ä–∏—Å–ª–∞—Ç—å —Å—Å—ã–ª–∫—É –Ω–∞ –≤–∏–¥–µ–æ—Ä–æ–ª–∏–∫, –∞ –Ω–µ —Å–∞–º –≤–∏–¥–µ–æ—Ä–æ–ª–∏–∫.

–ñ–µ–ª–∞–µ–º —É–¥–∞—á–∏!
        '''

        message21 = '''
–£–≤–∞–∂–∞–µ–º—ã–π –∫–∞–Ω–¥–∏–¥–∞—Ç!

üö®–ù–∞ –¥–∞–Ω–Ω—ã–π –º–æ–º–µ–Ω—Ç —É—Ä–æ–≤–µ–Ω—å  –í–∞—à–µ–≥–æ –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è –Ω–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –∫–≤–∞–ª–∏—Ñ–∏–∫–∞—Ü–∏–æ–Ω–Ω—ã–º —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º –¥–ª—è –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è –Ω–∞ –¥–æ–ª–∂–Ω–æ—Å—Ç—å —Å–æ–≤–µ—Ç–Ω–∏–∫–∞ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∞ –ø–æ –≤–æ—Å–ø–∏—Ç–∞–Ω–∏—é –∏ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—é —Å –¥–µ—Ç—Å–∫–∏–º–∏ –æ–±—â–µ—Å—Ç–≤–µ–Ω–Ω—ã–º–∏ –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏—è–º–∏.

–í—ã –º–æ–∂–µ—Ç–µ –ø—Ä–∏–Ω–∏–º–∞—Ç—å —É—á–∞—Å—Ç–∏–µ –≤ –∫–æ–Ω–∫—É—Ä—Å–µ, –Ω–æ –¥–ª—è –¥–∞–ª—å–Ω–µ–π—à–µ–≥–æ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è –Ω–∞ –¥–æ–ª–∂–Ω–æ—Å—Ç—å –≤ –æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω—É—é –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—é –í–∞–º –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –ø—Ä–æ–π—Ç–∏ –∫—É—Ä—Å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–≥–æ –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–æ–≥–æ –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è (–ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–æ–π –ø–µ—Ä–µ–ø–æ–¥–≥–æ—Ç–æ–≤–∫–∏) –ø–æ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—é –¥–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –≤ –æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω–æ–π –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏ (–ø–æ —É–∫—Ä—É–ø–Ω–µ–Ω–Ω–æ–π –≥—Ä—É–ø–ø–µ —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ—Å—Ç–µ–π –∏ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–π –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∏ ¬´–û–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –∏ –ø–µ–¥–∞–≥–æ–≥–∏—á–µ—Å–∫–∏–µ –Ω–∞—É–∫–∏¬ª) –∏ –ø–æ–ª—É—á–∏—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç –æ –ø—Ä–∏—Å–≤–æ–µ–Ω–∏–∏ –∫–≤–∞–ª–∏—Ñ–∏–∫–∞—Ü–∏–∏ –¥–æ 1 –∏—é–ª—è 2023 –≥–æ–¥–∞.

–°–ø–∞—Å–∏–±–æ!
        '''
        message22 = '''
–£–≤–∞–∂–∞–µ–º—ã–π —É—á–∞—Å—Ç–Ω–∏–∫ –∫–æ–Ω–∫—É—Ä—Å–∞, –≤—ã —É—Å–ø–µ—à–Ω–æ —Å–ø—Ä–∞–≤–∏–ª–∏—Å—å —Å –ø–µ—Ä–≤—ã–º —ç—Ç–∞–ø–æ–º –∏ —Ç–µ–ø–µ—Ä—å –º–æ–∂–µ—Ç–µ –ø—Ä–∏—Å—Ç—É–ø–∏—Ç—å –∫ —Ç–≤–æ—Ä—á–µ—Å–∫–æ–º—É –∑–∞–¥–∞–Ω–∏—é.

–î–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–¥–∞–Ω–∏—è –≤–∞–º –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –ø–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å –≤–∏–¥–µ–æ—Ä–æ–ª–∏–∫, –≤ –∫–æ—Ç–æ—Ä–æ–º –Ω—É–∂–Ω–æ —Ä–∞—Å–∫—Ä—ã—Ç—å —Å–≤–æ—é —ç–∫—Å–ø–µ—Ä—Ç–Ω—É—é –ø–æ–∑–∏—Ü–∏—é –≤ –æ–¥–Ω–æ–π –∏–∑ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–Ω—ã—Ö —Ç–µ–º–∞—Ç–∏–∫:

‚ñ´Ô∏è–ú–æ—Ç–∏–≤–∞—Ü–∏—è –¥–µ—Ç–µ–π –∫ —É—á–∞—Å—Ç–∏—é –≤ —à–∫–æ–ª—å–Ω—ã—Ö —Å–æ–±—ã—Ç–∏—è—Ö –∏ –ø—Ä–æ–µ–∫—Ç–∞—Ö
‚ñ´Ô∏è–ù–∞—Ä—É—à–µ–Ω–∏–µ –ø—Ä–∞–≤–∏–ª –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–≥–æ —Ä–∞—Å–ø–æ—Ä—è–¥–∫–∞ —à–∫–æ–ª—ã
‚ñ´Ô∏è–†–æ–¥–∏—Ç–µ–ª—å—Å–∫–æ–µ –º–Ω–µ–Ω–∏–µ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è –¥–µ—Ç–µ–π –∏–ª–∏ –¥–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω–æ–π –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏
‚ñ´Ô∏è–ö—É–ª—å—Ç—É—Ä–∞ —á—Ç–µ–Ω–∏—è
‚ñ´Ô∏è–ú–æ—Ç–∏–≤–∞—Ü–∏—è –∫–ª–∞—Å—Å–Ω—ã—Ö —Ä—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª–µ–π (–ø–µ–¥–∞–≥–æ–≥–æ–≤)
‚ñ´Ô∏è–ß–µ–º—É —É—á–∏—Ç —à–∫–æ–ª–∞

–û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ –Ω–∞ –æ—Å–Ω–æ–≤–Ω—ã–µ —Å–æ—Å—Ç–∞–≤–ª—è—é—â–∏–µ –∏ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ –≤–∏–¥–µ–æ—Ä–∞–±–æ—Ç–µ:
‚Äì –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ –∏ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ —É—á–∞—Å—Ç–Ω–∏–∫–∞ (–Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —á–µ—Ç–∫–æ –ø—Ä–æ–∏–∑–Ω–µ—Å—Ç–∏ —Å–≤–æ—ë –§–ò–û);
‚Äì –≤—ã–±—Ä–∞–Ω–Ω–∞—è —Ç–µ–º–∞—Ç–∏–∫–∞ (–Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –æ–∑–≤—É—á–∏—Ç—å —Ç–µ–º–∞—Ç–∏–∫—É –≤–æ–ø—Ä–æ—Å–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é);
‚Äì –ø–æ—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø—Ä–æ–±–ª–µ–º—ã –≤ —Ä–∞–º–∫–∞—Ö –≤—ã–±—Ä–∞–Ω–Ω–æ–π —Ç–µ–º–∞—Ç–∏–∫–∏ (—á—Ç–æ –∏–º–µ–Ω–Ω–æ –∏ –¥–ª—è –∫–∞–∫–∏—Ö —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ –æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω—ã—Ö –æ—Ç–Ω–æ—à–µ–Ω–∏–π —è–≤–ª—è–µ—Ç—Å—è –ø—Ä–æ–±–ª–µ–º–æ–π);
‚Äì –ø—Ä–∏–º–µ—Ä—ã –∏–∑ –ª–∏—Ç–µ—Ä–∞—Ç—É—Ä–Ω—ã—Ö –∏–ª–∏ –¥—Ä—É–≥–∏—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤, –∏–ª–ª—é—Å—Ç—Ä–∏—Ä—É—é—â–∏–µ –¥–∞–Ω–Ω—É—é –ø—Ä–æ–±–ª–µ–º—É;
‚Äì –≤–∞—Ä–∏–∞–Ω—Ç—ã —Ä–µ—à–µ–Ω–∏—è –¥–∞–Ω–Ω–æ–π –ø—Ä–æ–±–ª–µ–º—ã (–ø—Ä–µ–¥–ª–∞–≥–∞–µ–º—ã–µ —Å–æ–±—ã—Ç–∏—è –∏–ª–∏ –¥–µ–π—Å—Ç–≤–∏—è –≤ –≤–æ—Å–ø–∏—Ç–∞—Ç–µ–ª—å–Ω–æ–π —Ä–∞–±–æ—Ç–µ, –∫–æ—Ç–æ—Ä—ã–µ –¥–æ–ª–∂–Ω—ã –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–æ –ø–æ–≤–ª–∏—è—Ç—å –Ω–∞ —Ä–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã);
‚Äì –≤–æ–∑–º–æ–∂–Ω—ã–µ —Å–ø–æ—Å–æ–±—ã –∏ –∫—Ä–∏—Ç–µ—Ä–∏–∏ –æ—Ü–µ–Ω–∫–∏ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –ø—Ä–µ–¥–ª–∞–≥–∞–µ–º–æ–≥–æ —Ä–µ—à–µ–Ω–∏—è;
‚Äì —É–∫–∞–∑–∞–Ω–∏–µ –ø—Ä–æ–≥–Ω–æ–∑–∏—Ä—É–µ–º—ã—Ö –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤;
‚Äì –æ—Ü–µ–Ω–∫–∞ –≤–æ–∑–º–æ–∂–Ω—ã—Ö –Ω–µ–≥–∞—Ç–∏–≤–Ω—ã—Ö –ø–æ—Å–ª–µ–¥—Å—Ç–≤–∏–π –ø—Ä–µ–¥–ª–∞–≥–∞–µ–º–æ–≥–æ —Ä–µ—à–µ–Ω–∏—è;
 ‚Äì –ø—Ä–∏–º–µ—Ä –∏–∑ –ª–∏—á–Ω–æ–≥–æ –∏–ª–∏ –æ–±—â–µ—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –æ–ø—ã—Ç–∞, –∏–ª–ª—é—Å—Ç—Ä–∏—Ä—É—é—â–∏–π —Ä–µ—à–µ–Ω–∏–µ —É–∫–∞–∑–∞–Ω–Ω–æ–π –∏–ª–∏ –∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ–π –ø—Ä–æ–±–ª–µ–º—ã;

–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –∫ –≤–∏–¥–µ–æ—Ä–æ–ª–∏–∫—É:
‚Ä¢–ø—Ä–æ–¥–æ–ª–∂–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –≤–∏–¥–µ–æ –Ω–µ –±–æ–ª–µ–µ 5 –º–∏–Ω—É—Ç
‚Ä¢—Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏: —Å—ä–µ–º–∫–∞ –æ–¥–Ω–∏–º –∫–∞–¥—Ä–æ–º, —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ–º–æ–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ –∏ —Ä–∞–∑–º–µ—Ä –≤–∏–¥–µ–æ –Ω–µ –º–µ–Ω–µ–µ 1280—Ö720 (720—Ä)
‚Ä¢—Ñ–æ—Ä–º–∞—Ç: mp4
‚Ä¢—Ä–∞–±–æ—Ç–∞ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –ø–æ–ª–Ω–æ—Å—Ç—å—é
–≤—ã–ø–æ–ª–Ω–µ–Ω–∞ —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ, –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —É–∂–µ –∏–º–µ—é—â–µ–≥–æ—Å—è –º–∞—Ç–µ—Ä–∏–∞–ª–∞ –≤ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–µ –∑–∞–ø—Ä–µ—â–µ–Ω–æ
‚Ä¢–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –ª–∏—á–Ω–æ–µ –ø—Ä–∏—Å—É—Ç—Å—Ç–≤–∏–µ —É—á–∞—Å—Ç–Ω–∏–∫–∞ –≤ –∫–∞–¥—Ä–µ
‚Ä¢ —Ä–µ—á—å —É—á–∞—Å—Ç–Ω–∏–∫–∞ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –≤–Ω—è—Ç–Ω–æ–π –∏ —Ä–∞–∑–±–æ—Ä—á–∏–≤–æ–π
‚Ä¢ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å —á–µ—Ç–∫–∏–º
‚Ä¢ –Ω–µ –¥–æ–ø—É—Å–∫–∞–µ—Ç—Å—è –Ω–∞–ª–∏—á–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ —Ä–µ–∫–ª–∞–º–Ω–æ–≥–æ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∞, –∞ —Ç–∞–∫–∂–µ –ª—é–±—ã—Ö —Ñ–æ—Ä–º –ø–æ–ª–∏—Ç–∏—á–µ—Å–∫–æ–π, —Ä–µ–ª–∏–≥–∏–æ–∑–Ω–æ–π –∏–ª–∏ –∏–Ω–æ–π –∏–¥–µ–æ–ª–æ–≥–∏—á–µ—Å–∫–æ–π –ø—Ä–æ–ø–∞–≥–∞–Ω–¥—ã, –æ—Å–∫–æ—Ä–±–ª–µ–Ω–∏—è —á—É–≤—Å—Ç–≤ –∏ –¥–æ—Å—Ç–æ–∏–Ω—Å—Ç–≤ –¥—Ä—É–≥–∏—Ö –ª—é–¥–µ–π, –Ω–µ–Ω–æ—Ä–º–∞—Ç–∏–≤–Ω–æ–π –ª–µ–∫—Å–∏–∫–∏

–° –∫—Ä–∏—Ç–µ—Ä–∏—è–º–∏ –æ—Ü–µ–Ω–∏–≤–∞–Ω–∏—è —Ç–≤–æ—Ä—á–µ—Å–∫–æ–π —Ä–∞–±–æ—Ç—ã –≤—ã –º–æ–∂–µ—Ç–µ –æ–∑–Ω–∞–∫–æ–º–∏—Ç—å—Å—è –≤ –ø–æ–ª–æ–∂–µ–Ω–∏–∏: https://patriotsport.moscow/wp-content/uploads/2023/02/polozhenie_o_konkurse_navigatory_detstva_08_02_23.pdf

–ì–æ—Ç–æ–≤—ã–π –≤–∏–¥–µ–æ—Ä–æ–ª–∏–∫ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –∑–∞–≥—Ä—É–∑–∏—Ç—å –≤ –æ–±–ª–∞—á–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ (—è–Ω–¥–µ–∫—Å.–¥–∏—Å–∫, OneDrive, –æ–±–ª–∞–∫–æ Mail.ru) –∏ –ø—Ä–∏—Å–ª–∞—Ç—å —Å—Å—ã–ª–∫—É –Ω–∞ —Ñ–∞–π–ª –≤ —ç—Ç–æ—Ç —á–∞—Ç, –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –æ—Ç–∫—Ä—ã—Ç—å –¥–æ—Å—Ç—É–ø –¥–ª—è —Å–∫–∞—á–∏–≤–∞–Ω–∏—è –∏ –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ —Ñ–∞–π–ª–∞.  –ù–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∑–∞–¥–∞–Ω–∏—è –æ—Ç–≤–æ–¥–∏—Ç—Å—è 10 –¥–Ω–µ–π —Å –º–æ–º–µ–Ω—Ç–∞ –ø—Ä–∏—Ö–æ–¥–∞ –¥–∞–Ω–Ω–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è.

–î–ª—è –æ–ø–µ—Ä–∞—Ç–∏–≤–Ω–æ–≥–æ –ø–µ—Ä–µ—Ö–æ–¥–∞ –∫ —Å–ª–µ–¥—É—é—â–µ–º—É —ç—Ç–∞–ø—É –∫–æ–Ω–∫—É—Ä—Å–∞ (–∏—Ç–æ–≥–æ–≤–æ–µ —Å–æ–±–µ—Å–µ–¥–æ–≤–∞–Ω–∏–µ) –ø—Ä–æ—Å–∏–º –Ω–∞–ø—Ä–∞–≤–∏—Ç—å —Å—Å—ã–ª–∫—É –Ω–∞ –≤–∏–¥–µ–æ—Ä–æ–ª–∏–∫ –¥–æ 12 –º–∞—Ä—Ç–∞ 2023 –≥–æ–¥–∞.

–û–±—Ä–∞—â–∞–µ–º –≤–Ω–∏–º–∞–Ω–∏–µ, —á—Ç–æ –æ—Ç–≤–µ—Ç–Ω—ã–º —Å–æ–æ–±—â–µ–Ω–∏–µ–º –∑–¥–µ—Å—å –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –ø—Ä–∏—Å–ª–∞—Ç—å —Å—Å—ã–ª–∫—É –Ω–∞ –≤–∏–¥–µ–æ—Ä–æ–ª–∏–∫, –∞ –Ω–µ —Å–∞–º –≤–∏–¥–µ–æ—Ä–æ–ª–∏–∫.

–ñ–µ–ª–∞–µ–º —É–¥–∞—á–∏!'''

        message3 = '''
–ó–¥—Ä–∞–≤—Å—Ç–≤—É–π—Ç–µ, —É–≤–∞–∂–∞–µ–º—ã–π —É—á–∞—Å—Ç–Ω–∏–∫ –∫–æ–Ω–∫—É—Ä—Å–∞ ¬´–ù–∞–≤–∏–≥–∞—Ç–æ—Ä—ã –î–µ—Ç—Å—Ç–≤–∞¬ª!

–ù–∞–ø–æ–º–∏–Ω–∞–µ–º, —á—Ç–æ –í–∞–º –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –ø—Ä–æ–π—Ç–∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–æ 21 –º–∞—Ä—Ç–∞ 2023 –≥–æ–¥–∞.

–î–ª—è —ç—Ç–æ–≥–æ –Ω–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É –Ω–∏–∂–µ.
–ñ–µ–ª–∞–µ–º —É–¥–∞—á–∏!
        '''

        message41 = '''
        –£–≤–∞–∂–∞–µ–º—ã–π —É—á–∞—Å—Ç–Ω–∏–∫ –∫–æ–Ω–∫—É—Ä—Å–∞!

üö®–ù–∞ –¥–∞–Ω–Ω—ã–π –º–æ–º–µ–Ω—Ç —É—Ä–æ–≤–µ–Ω—å –í–∞—à–µ–≥–æ –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è –Ω–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –∫–≤–∞–ª–∏—Ñ–∏–∫–∞—Ü–∏–æ–Ω–Ω—ã–º —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º –¥–ª—è –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è –Ω–∞ –¥–æ–ª–∂–Ω–æ—Å—Ç—å —Å–æ–≤–µ—Ç–Ω–∏–∫–∞ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∞ –ø–æ –≤–æ—Å–ø–∏—Ç–∞–Ω–∏—é –∏ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—é —Å –¥–µ—Ç—Å–∫–∏–º–∏ –æ–±—â–µ—Å—Ç–≤–µ–Ω–Ω—ã–º–∏ –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏—è–º–∏.

–í—ã –º–æ–∂–µ—Ç–µ –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å —É—á–∞—Å—Ç–∏–µ –≤ –∫–æ–Ω–∫—É—Ä—Å–µ.
–ü—Ä–∏ —É—Å–ø–µ—à–Ω–æ–º –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏–∏ –≤—Å–µ—Ö —ç—Ç–∞–ø–æ–≤ –í—ã –ø–æ–ª—É—á–∏—Ç–µ —Å—Ç–∞—Ç—É—Å —Ñ–∏–Ω–∞–ª–∏—Å—Ç–∞, –Ω–æ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ –Ω–∞ –¥–æ–ª–∂–Ω–æ—Å—Ç—å —Å–æ–≤–µ—Ç–Ω–∏–∫–∞ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∞ –ø–æ –≤–æ—Å–ø–∏—Ç–∞–Ω–∏—é –∏ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—é —Å –¥–µ—Ç—Å–∫–∏–º–∏ –æ–±—â–µ—Å—Ç–≤–µ–Ω–Ω—ã–º–∏ –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏—è–º–∏ –≤ –æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω–æ–π –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏ –±—É–¥–µ—Ç –≤–æ–∑–º–æ–∂–Ω–æ —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ –ø–æ–ª—É—á–µ–Ω–∏—è –í–∞–º–∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞ –æ–± –æ—Å–≤–æ–µ–Ω–∏–∏ –≤—ã—Å—à–µ–≥–æ –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–æ–≥–æ –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è
        '''
        message42 = '''
        –£–≤–∞–∂–∞–µ–º—ã–π —É—á–∞—Å—Ç–Ω–∏–∫ –∫–æ–Ω–∫—É—Ä—Å–∞, –≤—ã —É—Å–ø–µ—à–Ω–æ —Å–ø—Ä–∞–≤–∏–ª–∏—Å—å —Å –ø–µ—Ä–≤—ã–º —ç—Ç–∞–ø–æ–º –∏ —Ç–µ–ø–µ—Ä—å –º–æ–∂–µ—Ç–µ –ø—Ä–∏—Å—Ç—É–ø–∏—Ç—å –∫ —Ç–≤–æ—Ä—á–µ—Å–∫–æ–º—É –∑–∞–¥–∞–Ω–∏—é.

–î–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–¥–∞–Ω–∏—è –≤–∞–º –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –ø–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å –≤–∏–¥–µ–æ—Ä–æ–ª–∏–∫, –≤ –∫–æ—Ç–æ—Ä–æ–º –Ω—É–∂–Ω–æ —Ä–∞—Å–∫—Ä—ã—Ç—å —Å–≤–æ—é —ç–∫—Å–ø–µ—Ä—Ç–Ω—É—é –ø–æ–∑–∏—Ü–∏—é –≤ –æ–¥–Ω–æ–π –∏–∑ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–Ω—ã—Ö —Ç–µ–º–∞—Ç–∏–∫:

‚ñ´Ô∏è–ú–æ—Ç–∏–≤–∞—Ü–∏—è –¥–µ—Ç–µ–π –∫ —É—á–∞—Å—Ç–∏—é –≤ —à–∫–æ–ª—å–Ω—ã—Ö —Å–æ–±—ã—Ç–∏—è—Ö –∏ –ø—Ä–æ–µ–∫—Ç–∞—Ö
‚ñ´Ô∏è–ù–∞—Ä—É—à–µ–Ω–∏–µ –ø—Ä–∞–≤–∏–ª –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–≥–æ —Ä–∞—Å–ø–æ—Ä—è–¥–∫–∞ —à–∫–æ–ª—ã
‚ñ´Ô∏è–†–æ–¥–∏—Ç–µ–ª—å—Å–∫–æ–µ –º–Ω–µ–Ω–∏–µ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è –¥–µ—Ç–µ–π –∏–ª–∏ –¥–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω–æ–π –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏
‚ñ´Ô∏è–ö—É–ª—å—Ç—É—Ä–∞ —á—Ç–µ–Ω–∏—è
‚ñ´Ô∏è–ú–æ—Ç–∏–≤–∞—Ü–∏—è –∫–ª–∞—Å—Å–Ω—ã—Ö —Ä—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª–µ–π (–ø–µ–¥–∞–≥–æ–≥–æ–≤)
‚ñ´Ô∏è–ß–µ–º—É —É—á–∏—Ç —à–∫–æ–ª–∞

–û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ –Ω–∞ –æ—Å–Ω–æ–≤–Ω—ã–µ —Å–æ—Å—Ç–∞–≤–ª—è—é—â–∏–µ –∏ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ –≤–∏–¥–µ–æ—Ä–∞–±–æ—Ç–µ:
‚Äì –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ –∏ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ —É—á–∞—Å—Ç–Ω–∏–∫–∞ (–Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —á–µ—Ç–∫–æ –ø—Ä–æ–∏–∑–Ω–µ—Å—Ç–∏ —Å–≤–æ—ë –§–ò–û);
‚Äì –≤—ã–±—Ä–∞–Ω–Ω–∞—è —Ç–µ–º–∞—Ç–∏–∫–∞ (–Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –æ–∑–≤—É—á–∏—Ç—å —Ç–µ–º–∞—Ç–∏–∫—É –≤–æ–ø—Ä–æ—Å–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é);
‚Äì –ø–æ—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø—Ä–æ–±–ª–µ–º—ã –≤ —Ä–∞–º–∫–∞—Ö –≤—ã–±—Ä–∞–Ω–Ω–æ–π —Ç–µ–º–∞—Ç–∏–∫–∏ (—á—Ç–æ –∏–º–µ–Ω–Ω–æ –∏ –¥–ª—è –∫–∞–∫–∏—Ö —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ –æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω—ã—Ö –æ—Ç–Ω–æ—à–µ–Ω–∏–π —è–≤–ª—è–µ—Ç—Å—è –ø—Ä–æ–±–ª–µ–º–æ–π);
‚Äì –ø—Ä–∏–º–µ—Ä—ã –∏–∑ –ª–∏—Ç–µ—Ä–∞—Ç—É—Ä–Ω—ã—Ö –∏–ª–∏ –¥—Ä—É–≥–∏—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤, –∏–ª–ª—é—Å—Ç—Ä–∏—Ä—É—é—â–∏–µ –¥–∞–Ω–Ω—É—é –ø—Ä–æ–±–ª–µ–º—É;
‚Äì –≤–∞—Ä–∏–∞–Ω—Ç—ã —Ä–µ—à–µ–Ω–∏—è –¥–∞–Ω–Ω–æ–π –ø—Ä–æ–±–ª–µ–º—ã (–ø—Ä–µ–¥–ª–∞–≥–∞–µ–º—ã–µ —Å–æ–±—ã—Ç–∏—è –∏–ª–∏ –¥–µ–π—Å—Ç–≤–∏—è –≤ –≤–æ—Å–ø–∏—Ç–∞—Ç–µ–ª—å–Ω–æ–π —Ä–∞–±–æ—Ç–µ, –∫–æ—Ç–æ—Ä—ã–µ –¥–æ–ª–∂–Ω—ã –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–æ –ø–æ–≤–ª–∏—è—Ç—å –Ω–∞ —Ä–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã);
‚Äì –≤–æ–∑–º–æ–∂–Ω—ã–µ —Å–ø–æ—Å–æ–±—ã –∏ –∫—Ä–∏—Ç–µ—Ä–∏–∏ –æ—Ü–µ–Ω–∫–∏ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –ø—Ä–µ–¥–ª–∞–≥–∞–µ–º–æ–≥–æ —Ä–µ—à–µ–Ω–∏—è;
‚Äì —É–∫–∞–∑–∞–Ω–∏–µ –ø—Ä–æ–≥–Ω–æ–∑–∏—Ä—É–µ–º—ã—Ö –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤;
‚Äì –æ—Ü–µ–Ω–∫–∞ –≤–æ–∑–º–æ–∂–Ω—ã—Ö –Ω–µ–≥–∞—Ç–∏–≤–Ω—ã—Ö –ø–æ—Å–ª–µ–¥—Å—Ç–≤–∏–π –ø—Ä–µ–¥–ª–∞–≥–∞–µ–º–æ–≥–æ —Ä–µ—à–µ–Ω–∏—è;
 ‚Äì –ø—Ä–∏–º–µ—Ä –∏–∑ –ª–∏—á–Ω–æ–≥–æ –∏–ª–∏ –æ–±—â–µ—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –æ–ø—ã—Ç–∞, –∏–ª–ª—é—Å—Ç—Ä–∏—Ä—É—é—â–∏–π —Ä–µ—à–µ–Ω–∏–µ —É–∫–∞–∑–∞–Ω–Ω–æ–π –∏–ª–∏ –∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ–π –ø—Ä–æ–±–ª–µ–º—ã;

–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –∫ –≤–∏–¥–µ–æ—Ä–æ–ª–∏–∫—É:
‚Ä¢–ø—Ä–æ–¥–æ–ª–∂–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –≤–∏–¥–µ–æ –Ω–µ –±–æ–ª–µ–µ 5 –º–∏–Ω—É—Ç
‚Ä¢—Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏: —Å—ä–µ–º–∫–∞ –æ–¥–Ω–∏–º –∫–∞–¥—Ä–æ–º, —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ–º–æ–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ –∏ —Ä–∞–∑–º–µ—Ä –≤–∏–¥–µ–æ –Ω–µ –º–µ–Ω–µ–µ 1280—Ö720 (720—Ä)
‚Ä¢—Ñ–æ—Ä–º–∞—Ç: mp4
‚Ä¢—Ä–∞–±–æ—Ç–∞ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –ø–æ–ª–Ω–æ—Å—Ç—å—é
–≤—ã–ø–æ–ª–Ω–µ–Ω–∞ —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ, –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —É–∂–µ –∏–º–µ—é—â–µ–≥–æ—Å—è –º–∞—Ç–µ—Ä–∏–∞–ª–∞ –≤ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–µ –∑–∞–ø—Ä–µ—â–µ–Ω–æ
‚Ä¢–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –ª–∏—á–Ω–æ–µ –ø—Ä–∏—Å—É—Ç—Å—Ç–≤–∏–µ —É—á–∞—Å—Ç–Ω–∏–∫–∞ –≤ –∫–∞–¥—Ä–µ
‚Ä¢ —Ä–µ—á—å —É—á–∞—Å—Ç–Ω–∏–∫–∞ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –≤–Ω—è—Ç–Ω–æ–π –∏ —Ä–∞–∑–±–æ—Ä—á–∏–≤–æ–π
‚Ä¢ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å —á–µ—Ç–∫–∏–º
‚Ä¢ –Ω–µ –¥–æ–ø—É—Å–∫–∞–µ—Ç—Å—è –Ω–∞–ª–∏—á–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ —Ä–µ–∫–ª–∞–º–Ω–æ–≥–æ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∞, –∞ —Ç–∞–∫–∂–µ –ª—é–±—ã—Ö —Ñ–æ—Ä–º –ø–æ–ª–∏—Ç–∏—á–µ—Å–∫–æ–π, —Ä–µ–ª–∏–≥–∏–æ–∑–Ω–æ–π –∏–ª–∏ –∏–Ω–æ–π –∏–¥–µ–æ–ª–æ–≥–∏—á–µ—Å–∫–æ–π –ø—Ä–æ–ø–∞–≥–∞–Ω–¥—ã, –æ—Å–∫–æ—Ä–±–ª–µ–Ω–∏—è —á—É–≤—Å—Ç–≤ –∏ –¥–æ—Å—Ç–æ–∏–Ω—Å—Ç–≤ –¥—Ä—É–≥–∏—Ö –ª—é–¥–µ–π, –Ω–µ–Ω–æ—Ä–º–∞—Ç–∏–≤–Ω–æ–π –ª–µ–∫—Å–∏–∫–∏

–° –∫—Ä–∏—Ç–µ—Ä–∏—è–º–∏ –æ—Ü–µ–Ω–∏–≤–∞–Ω–∏—è —Ç–≤–æ—Ä—á–µ—Å–∫–æ–π —Ä–∞–±–æ—Ç—ã –≤—ã –º–æ–∂–µ—Ç–µ –æ–∑–Ω–∞–∫–æ–º–∏—Ç—å—Å—è –≤ –ø–æ–ª–æ–∂–µ–Ω–∏–∏: https://patriotsport.moscow/wp-content/uploads/2023/02/polozhenie_o_konkurse_navigatory_detstva_08_02_23.pdf

–ì–æ—Ç–æ–≤—ã–π –≤–∏–¥–µ–æ—Ä–æ–ª–∏–∫ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –∑–∞–≥—Ä—É–∑–∏—Ç—å –≤ –æ–±–ª–∞—á–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ (—è–Ω–¥–µ–∫—Å.–¥–∏—Å–∫, OneDrive, –æ–±–ª–∞–∫–æ Mail.ru) –∏ –ø—Ä–∏—Å–ª–∞—Ç—å —Å—Å—ã–ª–∫—É –Ω–∞ —Ñ–∞–π–ª –≤ —ç—Ç–æ—Ç —á–∞—Ç, –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –æ—Ç–∫—Ä—ã—Ç—å –¥–æ—Å—Ç—É–ø –¥–ª—è —Å–∫–∞—á–∏–≤–∞–Ω–∏—è –∏ –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ —Ñ–∞–π–ª–∞.  –ù–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∑–∞–¥–∞–Ω–∏—è –æ—Ç–≤–æ–¥–∏—Ç—Å—è 10 –¥–Ω–µ–π —Å –º–æ–º–µ–Ω—Ç–∞ –ø—Ä–∏—Ö–æ–¥–∞ –¥–∞–Ω–Ω–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è.

–î–ª—è –æ–ø–µ—Ä–∞—Ç–∏–≤–Ω–æ–≥–æ –ø–µ—Ä–µ—Ö–æ–¥–∞ –∫ —Å–ª–µ–¥—É—é—â–µ–º—É —ç—Ç–∞–ø—É –∫–æ–Ω–∫—É—Ä—Å–∞ (–∏—Ç–æ–≥–æ–≤–æ–µ —Å–æ–±–µ—Å–µ–¥–æ–≤–∞–Ω–∏–µ) –ø—Ä–æ—Å–∏–º –Ω–∞–ø—Ä–∞–≤–∏—Ç—å —Å—Å—ã–ª–∫—É –Ω–∞ –≤–∏–¥–µ–æ—Ä–æ–ª–∏–∫ –¥–æ 12 –º–∞—Ä—Ç–∞ 2023 –≥–æ–¥–∞.

–û–±—Ä–∞—â–∞–µ–º –≤–Ω–∏–º–∞–Ω–∏–µ, —á—Ç–æ –æ—Ç–≤–µ—Ç–Ω—ã–º —Å–æ–æ–±—â–µ–Ω–∏–µ–º –∑–¥–µ—Å—å –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –ø—Ä–∏—Å–ª–∞—Ç—å —Å—Å—ã–ª–∫—É –Ω–∞ –≤–∏–¥–µ–æ—Ä–æ–ª–∏–∫, –∞ –Ω–µ —Å–∞–º –≤–∏–¥–µ–æ—Ä–æ–ª–∏–∫.

–ñ–µ–ª–∞–µ–º —É–¥–∞—á–∏!
        '''
        for interview in interviews:
            interview_answers = dict(interview.interview_answers)
            if not interview_answers.get('email'):
                continue
            rowItem = rows.get(interview_answers['email'])
            if not rowItem:
                continue
            try:
                if rowItem['isNeedSend'] == '1':
                    bot.send_message(
                        chat_id=interview.chat_id,
                        text=message11,
                        parse_mode=ParseMode.HTML,
                        reply_markup=ReplyKeyboardRemove()
                    )
                    bot.send_message(
                        chat_id=interview.chat_id,
                        text=message12,
                        parse_mode=ParseMode.HTML,
                        reply_markup=ReplyKeyboardRemove()
                    )
                    interview.is_send_final_message = 1
                    interview.update_step(InterviewStep.finish_end)
                elif rowItem['isNeedSend'] == '2':
                    bot.send_message(
                        chat_id=interview.chat_id,
                        text=message21,
                        parse_mode=ParseMode.HTML,
                        reply_markup=ReplyKeyboardRemove()
                    )
                    bot.send_message(
                        chat_id=interview.chat_id,
                        text=message22,
                        parse_mode=ParseMode.HTML,
                        reply_markup=ReplyKeyboardRemove()
                    )
                    interview.is_send_final_message = 1
                    interview.update_step(InterviewStep.finish_end)
                elif rowItem['isNeedSend'] == '3':
                    bot.send_message(
                        chat_id=interview.chat_id,
                        text=message3,
                        parse_mode=ParseMode.HTML,
                        reply_markup=ReplyKeyboardRemove()
                    )
                    interview.is_send_final_message = 1
                    interview.save()
                    # interview.update_step(InterviewStep.finish_end)
                elif rowItem['isNeedSend'] == '4':
                    bot.send_message(
                        chat_id=interview.chat_id,
                        text=message41,
                        parse_mode=ParseMode.HTML,
                        reply_markup=ReplyKeyboardRemove()
                    )
                    bot.send_message(
                        chat_id=interview.chat_id,
                        text=message42,
                        parse_mode=ParseMode.HTML,
                        reply_markup=ReplyKeyboardRemove()
                    )
                    interview.is_send_final_message = 1
                    interview.update_step(InterviewStep.finish_end)
            except Exception as error:
                bot.send_message(text=f'–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–ª–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –ø–æ—Å–ª–µ–¥–Ω–µ–º —ç—Ç–∞–ø–µ ‚Ññ {str(interview.chat_id)} ({str(interview_answers["email"])}) {str(error)}', chat_id=453548866)

        return rows

    @classmethod
    def refresh_test_results(cls):
        gc = gspread.service_account(filename=settings.GOOGLE_CREDENTIALS_FILE_PATH)
        spreadsheet = gc.open_by_key(settings.ADVISORS_RESULT_SPREADSHEET_ID)
        sheet = spreadsheet.worksheet('–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –æ–ø—Ä–æ—Å–∞')
        values = sheet.get_all_values()
        rows = {}
        lines = {}
        for idx, row in enumerate(values):
            lines.setdefault(idx + 1, [row[19]])
            rows.setdefault(row[7], idx + 1)
        interviews = Interview.objects.all()
        for interview in interviews:
            interview_answers = dict(interview.interview_answers)
            if not interview_answers.get('email'):
                continue
            lineIndex = rows.get(interview_answers['email'])
            if not lineIndex:
                continue
            lines[lineIndex] = [str(interview.questing_balls)]
        updateLine = []
        for value in lines.values():
            updateLine.append(value)
        sheet.update(f'T1', updateLine)

    @classmethod
    def refresh_table(cls):
        lines = []
        interviews = Interview.objects.all()
        for interview in interviews:
            try:
                interview_answers = dict(interview.interview_answers)
                if interview.step != InterviewStep.test.value and interview.step != InterviewStep.start_test.value \
                        and interview.step != InterviewStep.finish.value and not interview_answers['education_list'] \
                        and not interview_answers['adm_okr_list']:
                    continue

                education_list = []
                for value in dict(interview_answers['education_list']).values():
                    education_list.append(f'{value["place_education"]}, {value["napr_education"]}, '
                                          f'{value["place_education_stop"]}, '
                                          f'https://manager.cpvs.moscow/{value["doc_education"]};')

                work_list = []
                for value in dict(interview_answers['work_list']).values():
                    work_list.append(f'{value["work_experience"]}, {value["job_title"]};')
                print('1')
                lines.append([
                    interview.chat_id,
                    interview.step,
                    interview_answers['surname'],
                    interview_answers['name'],
                    interview_answers['patronymic'],
                    interview_answers['date_of_birth'],
                    interview_answers['gender'],
                    'https://manager.cpvs.moscow/' + interview_answers['photo'],
                    interview_answers['phone_number'],
                    interview_answers['email'],
                    interview_answers['social_networks'],
                    interview_answers['education_level'],
                    interview_answers['place_education'],
                    '\n'.join(education_list),
                    '\n'.join(work_list),
                    interview_answers['prof_skills'],
                    interview_answers['pers_qualities'],
                    interview_answers['achievements'],
                    interview_answers['exp_children'],
                    interview_answers['ed_oo_work'],
                    ', '.join(list(interview_answers['adm_okr_list'])),
                    str(interview.questing_balls)
                ])
            except Exception:
                pass
        gc = gspread.service_account(filename=settings.GOOGLE_CREDENTIALS_FILE_PATH)
        spreadsheet = gc.open_by_key(settings.ADVISORS_RESULT_SPREADSHEET_ID)
        sheet = spreadsheet.worksheet('–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –æ–ø—Ä–æ—Å–∞ (2)')
        sheet.update(f'A1', lines)

    @classmethod
    def update_goggle_table(cls):
        gc = gspread.service_account(filename=settings.GOOGLE_CREDENTIALS_FILE_PATH)
        spreadsheet = gc.open_by_key(settings.ADVISORS_RESULT_SPREADSHEET_ID)
        sheet = spreadsheet.worksheet('–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –æ–ø—Ä–æ—Å–∞')
        values = sheet.get_all_values()
        rows = {}
        for idx, row in enumerate(values):
            rows.setdefault(row[7], {
                'line': idx + 1,
            })

        interviews = Interview.objects.all()

        add_list = []
        for interview in interviews:
            interview_answers = dict(interview.interview_answers)
            if not interview_answers.get('email'):
                continue
            rowItem = rows.get(interview_answers['email'])
            if not rowItem:
                add_list.append(interview)
                continue

        next_row =  len(values) + 1
        start_row = next_row
        update_table_list = []

        for interview in add_list:
            interview_answers = dict(interview.interview_answers)

            education_list = []
            if 'adm_okr_list' not in interview_answers.keys():
                continue

            for value in dict(interview_answers['education_list']).values():
                education_list.append(f'{value["place_education"]}, {value["napr_education"]}, '
                                      f'{value["place_education_stop"]}, '
                                      f'https://manager.cpvs.moscow/{value["doc_education"]};')

            work_list = []
            for value in dict(interview_answers['work_list']).values():
                work_list.append(f'{value["work_experience"]}, {value["job_title"]};')

            questing_balls = ''
            if interview.questing_balls is not None:
                questing_balls = str(interview.questing_balls)

            video_url = ''
            if interview.video_url is not None:
                video_url = str(interview.video_url)

            update_table_list.append([
                interview_answers['surname'],
                interview_answers['name'],
                interview_answers['patronymic'],
                interview_answers['date_of_birth'],
                interview_answers['gender'],
                'https://manager.cpvs.moscow/' + interview_answers['photo'],
                interview_answers['phone_number'],
                interview_answers['email'],
                interview_answers['social_networks'],
                interview_answers['education_level'],
                interview_answers['place_education'],
                '\n'.join(education_list),
                '\n'.join(work_list),
                interview_answers['prof_skills'],
                interview_answers['pers_qualities'],
                interview_answers['achievements'],
                interview_answers['exp_children'],
                interview_answers['ed_oo_work'],
                ', '.join(list(interview_answers['adm_okr_list'])),
                questing_balls,
                video_url,
            ])
            interview.google_table_row = next_row
            interview.save()
            next_row += 1

        sheet.update(f'A{start_row}', update_table_list)
        return len(update_table_list)
